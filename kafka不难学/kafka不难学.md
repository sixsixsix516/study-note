**什么是消息队列**

消息队列是一个队列, 拥有先进先出的特性. 主要用于不同进程或线程之间的通信, 用来处理一系列的输入请求

消息队列采用异步通信机制, 即消息的发送者与接收者无需同时与消息队列进行数据交互, 消息会一致保存在队列中, 每一条消息记录都保存在队列中. 直至被接收者读取

**主要应用方向**

- 应用解耦 
- 异步处理
- 数据限流
- 消息通信



**角色**

- 代理: 一个Kafka进程（Kafka进程又称为Kafka实例）被称为一个代理（Broker）节点
- 生产者(producer) 生产者负责将消息记录发送到kafka集群指定的主题(topic)中进行存储
- 消费者(consumer) 从kafka集群指定的主题中读取消息的记录, 在读取主题数据是, 需要设置消费组名, 如果不设置, 则kafka消费者会默认生成一个消费组名称
- 消费者组(consumer group) 消费者程序在读取kafka系统主题topic中的数据时,通常会使用多个线程来执行,一个消费者组可以包含一个或多个消费者程序,使用分区和多线程模式可以极大提高读取数据的效率



**主题**  kafka系统通过主题来区分不用业务类型的消息记录

**分区**  一个主题可以有多个分区, 分区是基于物理层面上的, 不用的分区对应着不同的数据文件

​		kafka通过分区来支持物理层面上的并发读写, 以提高kafka集群的吞吐量

​		每个分区内部的消息记录都是有序的, 每个消息都有一个连续的偏移量序号(offset)

​		一个分区只对应一个代理节点(broker) 一个代理节点可以管理多个分区

**副本**  每个主题在创建时会要求指定它的副本数,默认是1, 通过副本机制来保证kafka分布式集群数据的高可用性

> 在创建主题时, 主题的副本系数值应如下设置
>
> 1. 若集群数量大于等于3, 副本系数值可以设置为3
> 2. 若集群数量小于3, 主题的副本系数值可以设置为小于或等于集群数量值

**记录 **被实际写入到kafka集群并且可以被消费者应用程序读取的数据, 每条记录包含一个键, 值, 时间戳



**kafka优点**

1. 高吞吐量 
2. 高可用
3. 低延时
4. 分布式机制

**特性**

- 异步生产数据 所有的写操作都是 将数据批量发送到kafka不同的代理(broker)节点,
- 偏移量迁移 消费者每次读取kafka主题中的数据时, 会产生消费记录, 比如偏移量,消费线程信息等, 之前(0.8.2前)是保存在zookeeper中, 现在是以内部主题的方式进行存储, 将其命名为 __consumer_offsets
- 安全机制 0.9版本后, 可以通过ssl和sasl安全机制来进行身份确认







